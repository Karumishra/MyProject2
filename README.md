# MyProject2
Blink Detector using CNN with python
I have developed a computer vision application for detecting if the eyes are open or close and count blinks. To achieve our goal we are going to train a small convolutional neural network (CNN) with Keras and then using OpenCV and dlib we ‘ll implement our blink detector. The process of building our blink detector has two stages, first the training of the neural network and then the development of the detector. 

Stage one :
To get started lets see what we need to train our cnn. We ‘ll use keras library with tensorflow backend, keras gives you the choise to use it with tensorflow or theano backend. Also you can use either python 2.7 or python 3.x . So we are going to train a binary classifier between open and close eyes. To do this we ‘ll need a dataset to train our classifier. For closed eyes we will use cropped images of size 26×34 from the Closed Eyes In The Wild (CEW) dataset and for opened eyes we used a manually anotaded images. We are going to use only left eye images because our dataset is small and we want the cnn to be more accurate, to achieve that we flipped the right images when we were cropping the whole face images. The complete dataset contains 2874 images.At first we read the csv file with the dictionary format and then we make a list with every row of the file. Then we make two empty numpy arrays to store the images and the tag of every image. After that we access through every row of the list, which contains an image and the image’s tag , to assert to the previous arrays their values. In the end we shuffle the two arrays and we return them. So to continue we are going to build our cnn using keras. Our network has three convolutional filters with relu activation, each filter followed by a max-pooling layer. Then we add dropout a dropout layer followed by two fully connected layers with relu activations also. Finally we add a single neuron with sigmoid activation for our binary classifier. As optimizer we ‘ll use adam and for our loss function we ‘ll use binary crossentropy.First we load our images and the tags at two numpy arrays, then we scale the values of the images between 0 and 1, we do that because it makes the learning process faster. After that we do some data augmentation at our data to artificially increase the number of the training examples, because we have a small dataset and we have to reduce overfitting. Finally we train out network for 50 epochs with batch size of 32 and we save our trained cnn. We know that normally we had to split our data at train, val and test sets, do some fine tuning and then train our network to evaluate it at our test set, but the purpose of this tutorial is to make fast a simple blink detector and not how to train a cnn classifier for open and close eyes. So to achieve that we don’t give a lot of importance to really important steps of the training.

Stage two :

Now we have our trained cnn and we are ready  to build our blink detector.  Lets see what libraries we ‘ll need.The computer vision library we are going to use is OpenCV.Overview of the detector: First we read each frame from the camera, then we crop the eyes and we give them to the cnn we have trained to make a prediction on them. After that we take the mean of the predictions because we look for blinks so we have to be sure. In the end we counter the consecutive close predictions and if they are more than a threshold we count it as a blink. Lets see some code.Now we ‘ll define a function for face detection. We ‘ll use haarcascade’s face detector because is faster than dlib’s frontal face detector.
